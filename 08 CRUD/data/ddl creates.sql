USE CRUD;

--
-- TABELA QUE GUARDA OS MUNICIPIOS
--
CREATE TABLE IF NOT EXISTS Municipio
(
	id INT NOT NULL AUTO_INCREMENT,
	nome VARCHAR(80) NOT NULL,
	estado VARCHAR(2) NOT NULL,
	latitude VARCHAR(10) NOT NULL DEFAULT "",
	longitude VARCHAR(10) NOT NULL DEFAULT "",
	
	PRIMARY KEY (id)
);

--
-- TABELA QUE REGISTRA OS USUARIOS
--
CREATE TABLE IF NOT EXISTS Usuario
(
	id INT NOT NULL AUTO_INCREMENT,
	dataRegistro DATETIME NOT NULL,
	nome VARCHAR(80) NOT NULL,
	email VARCHAR(80) NOT NULL,
	senha VARCHAR(80) NOT NULL,
	endereco VARCHAR(80) NOT NULL DEFAULT "",
	complemento VARCHAR(80) NOT NULL DEFAULT "",
	estado VARCHAR(2) NOT NULL DEFAULT "",
	municipio VARCHAR(80) NOT NULL DEFAULT "",
	cep VARCHAR(10) NOT NULL DEFAULT "",
	telefoneFixo VARCHAR(20) NOT NULL DEFAULT "",
	telefoneCelular VARCHAR(20) DEFAULT "",
	deveTrocarSenha INT NOT NULL DEFAULT 0,
	
	PRIMARY KEY (id)
);

--
-- TABELA QUE REGISTRA OS LOGINS DOS USUARIOS
--
CREATE TABLE IF NOT EXISTS UsuarioLogin
(
	id INT NOT NULL AUTO_INCREMENT,
	idUsuario INT NOT NULL,
	data TIMESTAMP NOT NULL,
	sucesso INT NOT NULL,
	
	PRIMARY KEY (id),
	FOREIGN KEY (idUsuario) REFERENCES Usuario(id)
);

--
-- TABELA QUE REGISTRA OS TOKENS DE TROCA DE SENHA
--
CREATE TABLE IF NOT EXISTS UsuarioToken
(
	id INT NOT NULL AUTO_INCREMENT,
	idUsuario INT NOT NULL,
	data TIMESTAMP NOT NULL,
	token VARCHAR(256) NOT NULL,
	
	PRIMARY KEY (id),
	FOREIGN KEY (idUsuario) REFERENCES Usuario(id)
);